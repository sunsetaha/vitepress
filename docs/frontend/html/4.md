# script 标签中 defer 和 async

在HTML的 `<script>` 标签中，defer和async属性用于控制脚本的加载和执行时机，它们的主要区别在于脚本的加载顺序、执行顺序以及与页面解析的关系：

**async属性**

- 异步加载：脚本的下载与页面的解析并行进行，这意味着页面的解析不会因为脚本的加载而阻塞。
- 非阻塞执行：脚本在下载完成后立即执行，无论其他async或defer脚本的状态如何。这意味着多个async脚本可能并行执行，执行顺序不确定。
- 可能的副作用：如果脚本之间存在依赖关系，async可能导致未按预期的顺序执行，从而可能产生错误或意料之外的行为。

**defer属性**
- 异步加载：脚本的下载也是异步进行的，但与async不同，defer脚本的执行是在整个文档解析完成之后，DOMContentLoaded事件触发之前。
- 按顺序执行：尽管脚本是异步加载的，但它们会按照在HTML文档中出现的顺序执行，这保证了脚本之间的依赖关系得到尊重。
- DOM操作安全：由于defer脚本在DOM完全加载后才执行，因此可以安全地进行DOM操作，而不用担心DOM元素尚未加载的问题。

**总结**
- 使用async适合那些不需要按照特定顺序执行且不会影响页面渲染的脚本。
- 使用defer适合那些需要按顺序执行的脚本，特别是那些依赖于DOM结构的脚本。

在实际应用中，选择使用async还是defer取决于脚本的具体需求和页面的整体性能优化策略。如果脚本间无依赖关系，使用async可以加速页面的加载速度；如果有依赖关系，使用defer可以确保脚本的正确执行顺序。